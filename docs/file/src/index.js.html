<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/index.js | javascript-entity-component-system</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/Stuhl/javascript-entitiy-component-system"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/esdoc.js~EntityComponentSystem.html">EntityComponentSystem</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/index.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">class EntityComponentSystem {
  constructor() {
    this.components = []
    this.processors = []
    this.entities = []
  }

  // debugging functions
  getProcessorNames() {
    return this.processors.map(processor =&gt; processor.name)
  }

  //get All
  getProcessors() {
    return this.processors
  }

  getComponents() {
    return this.components
  }

  getEntities() {
    return this.entities
  }

  // has functions, checks inside the arrays where the components, processors and entities are saved
  hasProcessor(processorName) {
    return this.processors.find(processor =&gt; processor.name === processorName)
  }

  hasComponent(componentName) {
    return this.components.find(component =&gt; component.name === componentName)
  }

  hasEntity(entityName) {
    return this.entities.find(entity =&gt; entity.name === entityName)
  }

  // entity utility functions
  createEntity(name, components) {
    let entity = {name, components}

    components.forEach(component =&gt; {
      const componentObject = this.components.find(ecsComponent =&gt; component === ecsComponent.name)
      entity = Object.assign(entity, componentObject.state)
    })
    return entity
  }

  entityHasComponent(entity, componentName) {
    return entity.components.includes(componentName)
  }

  removeComponentFromEntity(entity, componentName) {
    const indexOfComponent = entity.components.indexOf(componentName)
    if (indexOfComponent === -1) {
      throw new Error(&quot;Component not found on entity&quot;)
    } else {
      entity.components = entity.components.filter(component =&gt; component !== componentName)
      const component = ECS.getComponent(componentName)
      const keys = Object.keys(component.state)

      keys.forEach(key =&gt; {
        delete entity[key]
      })
    }
  }

  addComponentToEntity(entity, component) {
    if (ECS.entityHasComponent(entity, component.name)) {
      return
    }
    entity = Object.assign(entity, component.state ? component.state : {})
    entity.components.push(component.name)
  }

  // add functions, adds either entity, processor or component to the system
  addEntity(entity) {
    this.entities.push(entity)
  }

  addComponent(component) {
    this.components.push(component)
  }

  addProcessor(processor) {
    this.processors.push(processor)
  }

  getEntitiesFromComponent(componentName) {
    return this.entities.filter(entity =&gt; {
      return entity.components.includes(componentName)
    })
  }

  // gets specific processor, entity or component
  getComponent(componentName) {
    return this.components.find(component =&gt; componentName === component.name)
  }

  getProcessor(processorName) {
    return this.processors.find(proc =&gt; processorName === proc.name)
  }

  getEntity(entityName) {
    return this.entities.find(entity =&gt; entityName === entity.name)
  }

  runProcessors() {
    this.processors.forEach(processor =&gt; {
      const entities = this.getEntitiesFromComponent(processor.component)
      const component = this.getComponent(processor.component)
      processor.update(component, entities)
    })
  }

  runCustomLogicOnEntities() {
    this.entities.forEach(entity =&gt; {
      if (entity.update) {
        entity.update()
      }
    })
  }

  // call this inside the game loop!
  update() {
    this.runProcessors()
    this.runCustomLogicOnEntities()
  }
}

module.exports = EntityComponentSystem
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
